<!--INI-->
@model DAES.Web.BackOffice.Controllers.TaskModel





<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<title> Editor </title>

<style type="text/css">
    .editable {
        border: 1px solid #ccc;
        padding: 10px;
        width: 400px;
        height: 30px;
        display: block;
        overflow-y: scroll;
        scroll-behavior: auto;
        margin-bottom: 20px;
    }

    .tooltip {
        display: none;
        position: absolute;
        z-index: 10;
        box-shadow: 3px 2px 10px 1px #b0b0b0;
    }
</style>

<div class="panel panel-default">

    <div class="panel-heading">Formulario Innova</div>
    <div class="panel-body">
        @Html.AntiForgeryToken()
        @Html.HiddenFor(model => model.Workflow.WorkflowId)
        @Html.HiddenFor(model => model.Workflow.ProcesoId)
        @Html.HiddenFor(model => model.Workflow.Proceso.OrganizacionId)











        <div class="col-md-6">
            <button id="boldButton" class="btn btn-danger">Negrita</button>
            <button id="italicButton" class="btn btn-danger">Italic</button>
            <button id="subButton" class="btn btn-danger">Subrayar</button>
            <table>
                <tr>
                    <td>
                        @Html.LabelFor(model => model.Workflow.DocOficio.FirstOrDefault().Parrafo1, htmlAttributes: new { @class = "control-label col-md-6" })
                        <div class="col-md-12">
                            <div id="editableDiv" class="form-control col-md-12" contenteditable="true">Prueba1... </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        @Html.LabelFor(model => model.Workflow.DocOficio.FirstOrDefault().Parrafo2, htmlAttributes: new { @class = "control-label col-md-6" })
                        <div class="col-md-12">
                            <div id="editableDiv2" class="form-control col-md-12" contenteditable="true">Prueba2...</div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        @Html.LabelFor(model => model.Workflow.DocOficio.FirstOrDefault().Tabla, htmlAttributes: new { @class = "control-label col-md-6" })
                        <div class="col-md-12">
                            <div id="editableDiv3" class="form-control col-md-12" contenteditable="true">Prueba3 ...</div>
                        </div>
                    </td>
                </tr>
            </table>

            
        </div>

        <div class="col-md-6">vista  prvia  </div>

            <div>
                <button id="guardar" class="btn btn-danger">Guardar</button>
            </div>

        </div>








        @Ajax.ActionLink("VistaPrevia", "GuardarDocOfi", null, new { Model.OrganizacionId }, new AjaxOptions { UpdateTargetId = "transitorio" }, htmlAttributes: new { @class = "btn btn-success" })






    </div>
<script language="JavaScript">

    $(document).ready(function () {

        var $editableDiv = $('#editableDiv');
        var $editableDiv2 = $('#editableDiv2');
        var $editableDiv3 = $('#editableDiv3');
        var $boldButton = $('#boldButton');
        var $italicButton = $('#italicButton');
        var $subButton = $('#subButton');
        //var ediDiv = $('#ediDiv');
        var $ediDiv = $('#ediDiv');









        var $guardar = $('#guardar');

        $editableDiv.on('mouseup', function (e) {
            palabras(e);

        });
        $editableDiv2.on('mouseup', function (e) {
            palabras(e);

        });
        $editableDiv3.on('mouseup', function (e) {
            palabras(e);

        });

        $ediDiv.on('mouseup', function (e) {
            palabras(e);

        });

        function palabras(e) {

            var selectedText = window.getSelection().toString();

            if (selectedText.length > 0) {
                console.log("soy los botones");
                $boldButton.css({
                    top: e.pageY - 20,
                    left: e.pageX,

                }).show();

                $italicButton.css({
                    top: e.pageY - 20,
                    left: e.pageX + 60,
                }).show();

                $subButton.css({
                    top: e.pageY - 20,
                    left: e.pageX + 100,
                }).show();

            } else {

                $boldButton.show();
                $italicButton.show();
                $subButton.show();
            }
        };

        $guardar.on('click', function () {
            var div3 = document.getElementById("editableDiv3").innerHTML;
            var div = document.getElementById("editableDiv").innerHTML;
            var div2 = document.getElementById("editableDiv2").innerHTML;
            alert(div + "   " + div2 + " " + div3);

        });
        $boldButton.on('click', function () {
            document.execCommand('bold', false, null); // negrita
            $boldButton.show();
        });
        $italicButton.on('click', function () {
            document.execCommand('italic', false, null); // italica
            $italicButton.show();
        });
        $subButton.on('click', function () {
            document.execCommand('underline', false, null);//Subrayada
            $subButton.show();
        });

        $(document).on('click', function (e) {
            if ($(e.target).closest('#ediDiv').length === 0 && $(e.target).closest('#editableDiv2').length === 0 && $(e.target).closest('#editableDiv3').length === 0 && $(e.target).closest('#editableDiv').length === 0 && $(e.target).closest('#boldButton').length === 0 && $(e.target).closest('#italicButton').length === 0 && $(e.target).closest('#subButton').length === 0) {
                $boldButton.show();
                $italicButton.show();
                $subButton.show();

            }
        });
    });
</script>

<!--FIN-->
