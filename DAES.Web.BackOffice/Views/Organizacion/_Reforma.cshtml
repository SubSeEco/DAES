@model DAES.Model.SistemaIntegrado.Organizacion
@{ Model.ReformaAnteriors = Model.ReformaAnteriors.ToList().OrderByDescending(q => q.FechaPublicDiario).ToList(); }



<table class="table table-hover table-striped ">

    @for (var i = 0; i < Model.ReformaAnteriors.Count; i++)
    {

        @Html.HiddenFor(model => model.ReformaAnteriors[i].IdReformaAnterior) 
        @Html.HiddenFor(model => model.ReformaAnteriors[i].OrganizacionId)

        if (Model.TipoOrganizacionId == 1)
        {
    <thead>

        <tr>
            <th>
                @Html.LabelFor(model => model.TipoNormaId, "Tipo de Norma", htmlAttributes: new { @class = "control-label col-md-10" })
                @Html.DropDownListFor(model => Model.ReformaAnteriors[i].TipoNormaId, new SelectList(ViewBag.TipoNormaaId, "Value", "Text", Model.ReformaAnteriors[i].TipoNormaId), "Seleccione...", new { @class = "form-control col-md-10" })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].NNorma)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].NNorma, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
            <th colspan="2">
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].FechaNorma)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].FechaNorma, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
        </tr>
        <tr>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].AutorizadoPor)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].AutorizadoPor, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].FechaPublicDiario)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].FechaPublicDiario, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].TipoGeneralId)
                @Html.DropDownListFor(model => Model.ReformaAnteriors[i].TipoGeneralId, new SelectList(ViewBag.TipoGeneralId, "Value", "Text", Model.ReformaAnteriors[i].TipoGeneralId), "Seleccione...", new { @class = "form-control col-md-10" })
            </th>
        </tr>
        <tr>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].FechaJuntaGeneral)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].FechaJuntaGeneral, new { htmlAttributes = new { @class = "form-control", @style = "max-width: 1200px;" } })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].FechaEscritura)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].FechaEscritura, new { htmlAttributes = new { @class = "form-control", @style = "max-width: 1200px;" } })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].LugarNotario)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].LugarNotario, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
        </tr>
        <tr>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].DatosNotario)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].DatosNotario, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
            <th>
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].FechaReforma)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].FechaReforma, new { htmlAttributes = new { @class = "form-control col-md-10" } })
            </th>
        </tr>
        <tr>
            <th colspan="2">
                @Html.DisplayNameFor(model => Model.ReformaAnteriors[i].EspaciosDocAnterior)
                @Html.EditorFor(model => Model.ReformaAnteriors[i].EspaciosDocAnterior, new { htmlAttributes = new { @class = "form-control", @style = "max-width: 1200px;" } })
            </th>
        </tr>
        <tr>
            <td>

                @Ajax.ActionLink("Eliminar", "ReformaDeleteAnterior", null, new { Model.ReformaAnteriors.ToArray()[i].IdReformaAnterior, Model.ReformaAnteriors.ToArray()[i].OrganizacionId }, new AjaxOptions { UpdateTargetId = "reforma" }, new { @style = "Text-Decoration : none", @class = "btn btn-danger" })

            </td>
        </tr>
    </thead>
        
            }


        }
    <tbody>

        @for (var i = 0; i < Model.ReformaAnteriors.Count; i++)
        {

                @Html.HiddenFor(model => model.ReformaAnteriors[i].IdReformaAnterior)
                @Html.HiddenFor(model => model.ReformaAnteriors[i].OrganizacionId)
             <tr>

                    @if (Model.ReformaAnteriors[i].FechaReforma != null && Model.ReformaAnteriors[i].FechaReforma.Value.Date.CompareTo(Model.ReformaAnteriors.Where(q => q.FechaReforma == q.FechaReforma).OrderBy(q => q.FechaReforma).FirstOrDefault().FechaReforma) > 0)
                    {

                         <p class=" alert alert-success text-center">Esta es la última reforma</p>                    
                         break;

                    }

                    @if (Model.ReformaAnteriors.Count == 1 && Model.ReformaAnteriors[i].FechaReforma != null)
                    {
                        <p class=" alert alert-success text-center">Esta es la última reforma</p>                   
                        break;
                    }


            </tr>
            }
    </tbody>
</table>
